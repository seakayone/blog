<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
      <meta charset="utf-8"/>
      <title>Java: Null Handling with Optional</title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <meta name="description" content="Informal blog about software crafting and engineering. Not concluding list of topics: Software Quality, Testing, Backend Development, Tooling and Tipps."/>
      <meta name="author" content="Christian Kleinboelting"/>
      <meta name="keywords" content="Software, Clean Code, Software Testing, Java, Scala, Python"/>
      <meta name="generator" content="JBake"/>

      <!-- Le styles -->
      <link href="../../css/app.css" rel="stylesheet"/>
      <link rel="shortcut icon" href="../../favicon.ico"/>
      <!-- Begin Cookie Consent -->
      <script type="text/javascript">
          window.cookieconsent_options = {"message":"This blog uses cookies to ensure you get the best experience on our website","dismiss":"Got it!","learnMore":"More info","link":null,"theme":"dark-bottom"};
      </script>
      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/1.0.10/cookieconsent.min.js"></script>
      <!-- End Cookie Consent plugin -->
  </head>
  <body>
    <div class="title-bar">
      <div class="title-bar-left">
        <ul class="menu">
          <li class="menu-text"><span class="has-tip" title="[sɪst'ɛmɪk] pertaining to or affecting a system as a whole" aria-haspopup="true">Systemic</span> Blog</li>

          <li><a href="../../index.html">Home</a></li>
          <li><a href="../../about.html">About</a></li>
          <li><a href="../../archive.html">Archive</a></li>
        </ul>
      </div>
      <div class="title-bar-right hide-for-small-only">
        <ul class="menu">
          <li><a href="../../feed.xml">feed.xml</a></li>
        </ul>
      </div>
    </div>

    <div class="row" id="content">
      <div class="medium-8 medium-offset-2 columns end">
        <div class="blog-post">
          <h1>Java: Null Handling with Optional</h1>
          <p><em>24 May 2018</em></p>
          <p><div class="paragraph"> 
 <p>Java has made <a href="https://www.infoq.com/presentations/Null-References-The-Billion-Dollar-Mistake-Tony-Hoare">the billion dollar mistake</a>. Its creators decided it is a good idea to implement the <code>null</code> reference. This reference leads developers having to deal a lot with unexpected behaviours and the ubiquitious <code>NullPointerException</code>. The problem with <code>null</code> is that it does not provide convenient ways to deal with its presence other than checking for its existence. This way it is subverting any type system, making the code hard to read and debug and possibly leads to bad design.</p> 
</div> 
<div class="paragraph"> 
 <p>Have you ever seen code with lots of nested if statements and cringed?</p> 
</div> 
<div class="listingblock"> 
 <div class="content"> 
  <pre class="prettyprint highlight"><code class="language-java" data-lang="java">Foo foo = someMethodWhichReturnsFooOrNull();
if (foo != null) {
  Bar bar = foo.getBar(); // foo.getBar() returns Bar or null
  if (bar != null) {
    bar.doBaz();
  }
}</code></pre> 
 </div> 
</div> 
<div class="paragraph"> 
 <p>Using Java 8’s <code>Optional&lt;T&gt;</code> type and method references we could simplify the above code to look like this:</p> 
</div> 
<div class="listingblock"> 
 <div class="content"> 
  <pre class="prettyprint highlight"><code class="language-java" data-lang="java">someMethodWhichReturnsOptionalFoo()
  .flatMap(Foo::getBarOptional())
  .ifPresent(Bar::doBaz);</code></pre> 
 </div> 
</div> 
<div class="paragraph"> 
 <p>IMHO this would make the code not only shorter but also easier to read. The <code>Optional</code> seems to sooth our pain. Essentially <code>Optional</code> models the behaviour that a value can be present or absent and this way provides certain operations which will be executed if and only if the value is present seemingly making the dreaded <code>NullPointerException</code> vanish.</p> 
</div> 
<div class="paragraph"> 
 <p>All good, right? This should allow us to write better code in terms of readability and null safeness. Not entirely: Unfortunately Java still allows to return null for any method. This means that even methods with a return value of <code>Optional</code> can actually return <code>null</code>. In the example above for example if the <code>getBarOptional</code> method returns <code>null</code> we would get a <code>NullPointerException</code> from the <code>flatMap</code> as this (<a href="https://developer.atlassian.com/blog/2015/08/optional-broken/">admittedly awkwardly</a>) requires the return value to be not <code>null</code>.</p> 
</div> 
<div class="paragraph"> 
 <p>So we are back at square one leaving developers behind with only self-discipline and code. With <code>Optional</code> the code will at least be more readable though.</p> 
</div> 
<div class="paragraph"> 
 <p>In a later article I will present a way how to statically analyse our code and ensuring that <code>null</code> is never returned accidentally. I will also show how to use annotations to make it clearer for a developer that one has to deal with <code>null</code>, making writing Java more like the Kotlin way of handling <code>null</code> in that preventing the use of <code>null</code> will become the default way of writing code.</p> 
</div></p>
        </div>
        <div id="disqus_thread"></div>
        <script>
          var disqus_config = function () {
              this.page.url = 'http://seakayone.github.io/blog/';
              this.page.identifier = 'systemic-noise';
          };
          (function() {
            var d = document, s = d.createElement('script');
            s.src = '//systemic-noise.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      </div>
    </div>
    <div>
      <div class="row column">
        <ul class="menu">
          <li><a href="#">Top</a></li>
        </ul>
      </div>
      <script src="../../js/jquery.js"></script>
      <script src="../../js/foundation.min.js"></script>
      <script src="../../js/prettify.js"></script>
      <script src="../../js/app.js"></script>
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-83282715-1', 'auto');
        ga('send', 'pageview');

      </script>
    </div>
  </body>
</html>
